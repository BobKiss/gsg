jQuery(document).ready(function(s){"use strict";var i={message:"",css:{border:"none",background:"transparent"},overlayCSS:{background:"#fff",opacity:.7},ignoreIfBlocked:!0},e=function(t){t.each(function(){var t=s(this);t.is("input")?"checkbox"===t.attr("type")?t.removeAttr("checked"):"text"!==t.attr("type")&&"number"!==t.attr("type")||t.val(""):t.is("textarea")&&t.val("")})},n=function(t){var n=!!t.length&&{};return t.each(function(){if(!1!==n){var t=s(this),e=t.data("name")||!1,i=t.data("required")||"no";e&&(t.is("input[type=checkbox]")?t.is(":checked")&&(n[e]=t.val()):n[e]=t.val()),"yes"===i&&""===t.val()&&(t.focus(),n=!1)}}),n},o=".bk_show_if_customer_chooses_blocks",c=".bk_show_if_can_be_cancelled",a=".bk_show_if_customer_one_day",r=".bk_show_if_booking_has_persons",_=".bk_show_if_day",d=".bk_show_if_time",l=".bk_show_if_fixed_and_time",u=".bk_show_if_unit_is_month",h=".bk_show_if_unit_is_day",k=".bk_show_if_unit_is_hour",f=".bk_show_if_unit_is_minute",b=function(t,e){e?s(t).show():s(t).hide()},g=s("#_yith_booking_duration_minute_select"),y=s("#_yith_booking_duration"),m=s("select#_yith_booking_duration_type"),p=s("select#_yith_booking_duration_unit"),t=s("select#product-type"),w=t.val();g.hide().on("change",function(){y.val(s(this).val())}),s(document).find("._tax_status_field").closest("div").addClass("show_if_"+wcbk_admin.prod_type),t.on("change",function(){w!==wcbk_admin.prod_type&&wcbk_admin.prod_type===s(this).val()&&s("#_virtual").attr("checked","checked").trigger("change")}).trigger("change"),m.on("change",function(){var t="customer"===s(this).val();b(o,t)}).trigger("change"),s("input#_yith_booking_can_be_cancelled").on("change",function(){var t=s(this).is(":checked");b(c,t)}).trigger("change"),s(document).on("check_if_customer_one_day",function(){var t=m.val(),e=s("input#_yith_booking_duration").val(),i=s("select#_yith_booking_duration_unit").val();b(a,"customer"===t&&"1"===e&&"day"===i)}).trigger("check_if_customer_one_day"),s(document).on("change","#_yith_booking_duration_type, #_yith_booking_duration, #_yith_booking_duration_unit",function(){s(document).trigger("check_if_customer_one_day")}),s(document).on("check_if_fixed_and_time",function(){var t="fixed"===m.val(),e=p.val();b(l,t&&("hour"===e||"minute"===e))}).trigger("check_if_fixed_and_time"),s(document).on("change","#_yith_booking_duration_type, #_yith_booking_duration_unit",function(){s(document).trigger("check_if_fixed_and_time")}),s("input#_yith_booking_has_persons").on("change",function(){var t=s(this).is(":checked");b(r,t)}).trigger("change"),p.on("change",function(){var t=s(this).val(),e="hour"===t||"minute"===t,i="day"===t;b(d,e),b(_,i),b(u,"month"===t),b(h,"day"===t),b(k,"hour"===t),b(f,"minute"===t),"minute"===t?(y.hide(),g.show().trigger("change")):(g.hide(),y.show()),s(document).trigger("yith_wcbk_booking_product_duration_unit_changed",[{value:t,has_time:e,is_day:i}])}).trigger("change");var v=s("#yith-wcbk-booking-costs-table"),x=v.find("tr.yith-wcbk-costs-default-row").first(),C=s("#yith-wcbk-costs-add-range"),E=s("#"+v.data("fields-container-id")),I=E.find(".yith-wcbk-admin-input-range"),D=E.find(".yith-wcbk-number-range"),S=E.find(".yith-wcbk-month-range-select"),j=E.find(".yith-wcbk-week-range-select"),q=E.find(".yith-wcbk-day-range-select");E.find(".yith-wcbk-time-range-input");v.on("change","select.yith-wcbk-costs-range-type-select",function(t){var e,i,n=s(t.target),o=n.closest("tr"),c=o.find("td.yith-wcbk-costs-from"),a=o.find("td.yith-wcbk-costs-to"),r=n.val();switch(r){case"custom":e=I.clone().addClass("yith-wcbk-admin-date-picker").yith_wcbk_datepicker(),i=I.clone().addClass("yith-wcbk-admin-date-picker").yith_wcbk_datepicker();break;case"month":e=S.clone(),i=S.clone();break;case"week":e=j.clone(),i=j.clone();break;case"day":e=q.clone(),i=q.clone();break;case"time":break;default:e=D.clone(),i=D.clone()}"time"===r?(e.find("input").attr("name","_yith_booking_costs_range[from][]"),i.find("input").attr("name","_yith_booking_costs_range[to][]")):(e.attr("name","_yith_booking_costs_range[from][]"),i.attr("name","_yith_booking_costs_range[to][]")),c.html(e),a.html(i)}).on("click",".yith-wcbk-delete",function(t){s(t.target).closest("tr").remove()}).find("tbody").sortable({items:"tr",cursor:"move",handle:".yith-wcbk-anchor",axis:"y",scrollSensitivity:40,forcePlaceholderSize:!0,opacity:.65,helper:function(t,e){var i=e.children(),n=e.clone();return n.children().each(function(t){s(this).width(i.eq(t).width())}),n}}),C.on("click",function(){var t=x.clone().removeClass("yith-wcbk-costs-default-row");v.append(t),t.find("select.yith-wcbk-costs-range-type-select").trigger("change")}),s(".yith-wcbk-google-maps-places-autocomplete").each(function(){new google.maps.places.Autocomplete(this)}),s(".yith-wcbk-product-sync-imported-calendars-table").on("click",".insert",function(t){t.preventDefault();var e,i=s(t.target),n=i.data("row"),o=i.closest(".yith-wcbk-product-sync-imported-calendars-table"),c=o.find("tbody");o.data("last-index")?e=o.data("last-index")+1:(e=c.find("tr").length||0,e+=1),o.data("last-index",e),n=n.replace(new RegExp("{{INDEX}}","g"),e),c.append(s(n))}).on("click",".delete",function(t){t.preventDefault(),s(t.target).closest("tr").remove()});var P=function(){var t,e,i,n=p.val(),o=y.val();e=o<2?(t=wcbk_admin.i18n_durations[n].singular.replace("%s",o),wcbk_admin.i18n_durations[n].singular_qty.replace("%s",o)):(t=wcbk_admin.i18n_durations[n].plural.replace("%s",o),wcbk_admin.i18n_durations[n].plural_qty.replace("%s",o)),i=wcbk_admin.i18n_durations[n].plural_unit,s(".yith-wcbk-product-metabox-dynamic-duration").html(t),s(".yith-wcbk-product-metabox-dynamic-duration-qty").html(e),s(".yith-wcbk-product-metabox-dynamic-duration-unit").html(i)};s(document).on("change","#_yith_booking_duration, #_yith_booking_duration_unit",P),s(document).on("yith_wcbk_product_metabox_dynamic_durations",P),P();var T={container:s("#yith-wcbk-people-types__create"),list:s("#yith-wcbk-people-types__list"),fields:s("#yith-wcbk-people-types__create .yith-wcbk-fake-form-field"),init:function(){var t=T;t.container.on("keydown",t.prevent_submit_on_enter).on("click",".yith-wcbk-people-types__create-submit",t.create).hide(),s("#yith-wcbk-people-types__create-btn").on("click",t.toggle)},close:function(){T.container.slideUp(200)},toggle:function(){T.container.slideToggle(200)},prevent_submit_on_enter:function(t){if(13===t.keyCode)return t.preventDefault(),!1},reset_form:function(){var t=T.fields;e(t)},get_form_data:function(){var t=T.fields;return n(t)},create:function(){var t=T.container,e=T.get_form_data();e&&(e.action="yith_wcbk_create_people_type",t.block(i),s.ajax({type:"POST",data:e,url:ajaxurl,success:function(t){t.message&&alert(t.message),t.id&&t.title&&(T.add_row(t.id,t.title),T.reset_form(),T.close())},complete:function(){t.unblock()}}))},add_row:function(t,e){var i=wp.template("yith-wcbk-people-type-row");T.list.append(s(i({id:t,title:e})))}};T.init();var A={container:s("#yith-wcbk-services__create"),fields:s("#yith-wcbk-services__create .yith-wcbk-fake-form-field"),services:s("#_yith_wcbk_booking_services"),init:function(){var t=A;t.container.on("keydown",t.prevent_submit_on_enter).on("click",".yith-wcbk-services__create-submit",t.create).hide(),s("#yith-wcbk-services__create-btn").on("click",t.toggle)},close:function(){A.container.slideUp(400)},toggle:function(){A.container.slideToggle(400)},prevent_submit_on_enter:function(t){if(13===t.keyCode)return t.preventDefault(),!1},reset_form:function(){var t=A.fields;e(t)},get_form_data:function(){var t=A.fields;return n(t)},create:function(){var t=A.container,e=A.get_form_data();e&&(e.action="yith_wcbk_create_service",t.block(i),s.ajax({type:"POST",data:e,url:ajaxurl,success:function(t){if(t.message&&alert(t.message),t.id&&t.title){var e=s('<option value="'+t.id+'" selected="selected">'+t.title+"</option>");A.services.append(e),A.services.removeClass("enhanced"),s(document.body).trigger("wc-enhanced-select-init"),A.services.focus(),A.reset_form(),A.close()}t.debug&&console.log(t.debug)},complete:function(){t.unblock()}}))}};A.init();var N={list:s("#yith-wcbk-extra-costs__list"),customExtraCosts:!1,lastIndex:1,init:function(){this._initParams(),s("#yith-wcbk-extra-costs__new-extra-cost").on("click",this.addExtraCost),s(document).on("click",".yith-wcbk-extra-cost__delete",this.deleteExtraCost)},_initParams:function(){this.customExtraCosts=this.list.find(".yith-wcbk-extra-cost--custom"),this.lastIndex=this.customExtraCosts.length||0},nextIndex:function(){return++this.lastIndex},addExtraCost:function(t){t.preventDefault();var e,i=s(t.target).data("template"),n=N.nextIndex();i=i.replace(new RegExp("{{INDEX}}","g"),n),e=s(i),N.list.append(e),e.find(".yith-wcbk-extra-cost__name").first().focus()},deleteExtraCost:function(t){s(t.target).closest(".yith-wcbk-extra-cost").remove()}};N.init()});